<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="favicon.png">
	<style>
		body {
			padding: 0;
			margin: 0;
			overflow: hidden;
		}
		#main {
			background-image: url("game-background.jpg");
			background-repeat: no-repeat;
			background-attachment: fixed;
			background-size: cover;
		}
	</style>
	<title>/- MUNO -/</title>
</head>
<body>
	<canvas id="main"></canvas>

	<script src="socket.io/socket.io.js"></script>
	<script>
		const socket = io();
		const gameId = (new URLSearchParams((new URL(window.location.href)).search)).get("room");

		socket.on("console-log",(data)=>console.log(data));

		var roomId = "Buscando...";

		if (gameId) {
			socket.emit("join-game",gameId);
			roomId = gameId;
		} else {
			socket.emit("search-game");
		}

		socket.on("return-error",(msg)=>window.location.href = "http://"+window.location.host + "/?error="+msg);

		const canvas = document.getElementById("main");
		const ctx = canvas.getContext("2d");

		var players = 0;
		var admin = false;

		socket.on("joined-game",(data)=>{
			roomId = data.id;
		});

		socket.on("room-update",(data)=>{
			players = data.players;
			admin = data.admin;
		});

		setInterval(()=>{
			canvas.width = window.innerWidth;
			canvas.height = window.innerHeight;

			ctx.font = "30px Arial";
			ctx.fillText("Room: "+roomId,50,50);
			ctx.fillText("Players: "+players,50,150);
			if (admin) {
				ctx.fillText("You're admin",50,200);
			}
		},50/3);
	</script>
</body>
</html>